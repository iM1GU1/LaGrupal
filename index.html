<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LA GRUPAL</title>
</head>
<body>
    <h1>Bienvenid@ a La Grupal!</h1>
    <p id="user-welcome" style="display: none;"></p>
    <p>Empezemos la aventura:</p>

    <form onsubmit="return registerUser()">
        <label for="email">Escribe tu mail:</label>
        <input type="email" id="email" name="email" required><br>

        <label for="password">Pon tu contraseña ultra secreta:</label>
        <input type="password" id="password" name="password" required><br>

        <label for="username">Escribe un nombre mega molón:*</label>
        <input type="text" id="username" name="username" required><br>

        <p>¿Eres chico o chica?</p>
        <input type="radio" id="male" name="gender" value="male">
        <label for="male">Chico</label><br>
        <input type="radio" id="female" name="gender" value="female">
        <label for="female">Chica</label><br>

        <input type="submit" value="Submit">
    </form>

    <!-- Botón de cierre de sesión -->
    <button id="user-logout" style="display: none;">Cerrar Sesión</button>

    <div id="error-message" style="color: red; display: none;">Correo ya registrado</div>

    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-auth.js"></script>
    <script>
        // Firebase configuration
        var firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            databaseURL: "YOUR_DATABASE_URL",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID",
            measurementId: "YOUR_MEASUREMENT_ID"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        // Firebase Authentication functions go here (as mentioned in previous responses).
        function registerUser() {
            // Firebase Authentication code for registration
            // ...
        }

        // Detectar cambios en el estado de autenticación del usuario
        firebase.auth().onAuthStateChanged(function(user) {
            if (user) {
                // El usuario ha iniciado sesión
                // Aquí puedes mostrar el nombre del usuario y la opción de cerrar sesión
                var userDisplayName = user.displayName;
                var userWelcome = document.getElementById('user-welcome');
                var userLogoutButton = document.getElementById('user-logout');

                userWelcome.textContent = '¡Hola, ' + userDisplayName + '!';
                userWelcome.style.display = 'block';
                userLogoutButton.style.display = 'block';

                // Actualizar el nombre del usuario
                var user = firebase.auth().currentUser;
                user.updateProfile({
                    displayName: "Nombre de Usuario"
                }).then(function() {
                    // El nombre del usuario se ha actualizado correctamente
                }).catch(function(error) {
                    // Manejar errores si es necesario
                });
            } else {
                // El usuario no ha iniciado sesión
                // Aquí puedes ocultar el nombre del usuario y la opción de cerrar sesión
                var userWelcome = document.getElementById('user-welcome');
                var userLogoutButton = document.getElementById('user-logout');

                userWelcome.style.display = 'none';
                userLogoutButton.style.display = 'none';
            }
        });

        var userLogoutButton = document.getElementById('user-logout');
        userLogoutButton.addEventListener('click', function() {
            firebase.auth().signOut().then(function() {
                // Cierre de sesión exitoso
                // Puedes redirigir al usuario a una página de inicio de sesión o realizar otras acciones aquí
            }).catch(function(error) {
                // Manejar errores de cierre de sesión si es necesario
            });
        });
    </script>
</body>
</html>
